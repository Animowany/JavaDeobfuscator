package uwu.narumi.deobfuscator.core.other.impl.exploit;

import uwu.narumi.deobfuscator.api.asm.ClassWrapper;
import uwu.narumi.deobfuscator.api.context.Context;
import uwu.narumi.deobfuscator.api.transformer.Transformer;

public class WebExploitRemoveTransformer extends Transformer {

  @Override
  public void transform(ClassWrapper scope, Context context) throws Exception {
    context.getClasses().entrySet().removeIf(entry -> entry.getKey().contains("<html>"));
    context.getFiles().entrySet().removeIf(entry -> entry.getKey().contains("<html>"));

    context
        .classes()
        .forEach(
            classWrapper ->
                classWrapper.methods().removeIf(methodNode -> methodNode.name.contains("<html>")));
    context
        .classes()
        .forEach(
            classWrapper ->
                classWrapper.fields().removeIf(fieldNode -> fieldNode.name.contains("<html>")));
  }
}
